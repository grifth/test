<!DOCTYPE html>
<html lang="zh-hans">
<head>
    <meta charset="UTF-8">
    <title>导航</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header></header>
    <main>
    	<div id="main" class="wrapper"></div>
    </main>
</body>
<script>
	//1、初始化数据
var keys = {
    '0': { 0: 'q', 1: 'w', 2: 'e', 3: 'r', 4: 't', 5: 'y', 6: 'u', 7: 'i', 8: 'o', 9: 'p', length: 10 },
    '1': { 0: 'a', 1: 's', 2: 'd', 3: 'f', 4: 'g', 5: 'h', 6: 'j', 7: 'k', 8: 'l', length: 9 },
    '2': { 0: 'z', 1: 'x', 2: 'c', 3: 'v', 4: 'b', 5: 'n', 6: 'm', length: 7 },
    'length': 3
}

var hash = {'q': 'qq.com', 'w': 'weibo.com', 'e': 'ele.me', 'r': 'renren.com', 't': 'tianya.com', 'y': 'youtube.com', 'u': 'uc.com' , 'i': 'iqiyi.com', 'o': 'opera.com', 'p': undefined, 'a': 'acfun.tv', 's': 'sohu.com', 'z': 'zhihu.com', 'm': 'www.mcdonalds.com.cn' }

var hashInLocalStorage = getFromLocalStage('zzz');

if(hashInLocalStorage){
	hash = hashInLocalStorage
}



//2、生成键盘
for(var index =0; index<keys['length'];index++){
	var row = keys[index]
	var div = dc('div')
	div.className ='row';
	main.appendChild(div);
	for(var i = 0; i<row['length'];i++){
		var span = createspan(row[i])
		var button = createbutton(row[i])

		var img = createimage(hash[row[i]])

		var	kbd = dc('kbd');
		kbd.className = 'key';
		kbd.appendChild(span);
		kbd.appendChild(img);
		kbd.appendChild(button);
		div.appendChild(kbd);

	}

}

//3.监听事件
document.onkeypress = function(event){
	key = event.key;
	website = hash[key];
	// location.href = 'http://'+website
	window.open('http://'+website,'_blank')
}



function getFromLocalStage(name){
	return JSON.parse(localStorage.getItem(name) || 'null');
}

function dc(tagname){
	return document.createElement(tagname)
}

function createspan(textContent){
		var span = dc('span');
		span.textContent = textContent;
		span.className = 'text';
		return span;
}
function createbutton(id){
		var button = dc('button');
		button.textContent='编辑';
		button.id=id;
		button.onclick=function(event){
		var	key = event.target.id;
		var x =prompt('给我网站');
		var button2 = event['target'];
		var img2 = button2.previousSibling;
		hash[key] = x;
		localStorage.setItem('zzz',JSON.stringify(hash));
		img2.src = 'http://'+ x +'/favicon.ico';
		img2.onerror = function(event){
			evnet.taerget.src = "	i.loli.net/2017/11/10/5a05afbc5e183.png"
		}
		localStorage.setItem('zzz',JSON.stringify(hash))
		}
		return button;
}
function createimage(domain){
		var img = dc('img')
		if(domain){
			img.src = 'http://'+domain+'/favicon.ico';
		}else{
			img.src="//i.loli.net/2017/11/10/5a05afbc5e183.png"
		}
		img.onerror = function(event){
			event.target.src = "//i.loli.net/2017/11/10/5a05afbc5e183.png"
		}
		return img;
}
</script>

</html>